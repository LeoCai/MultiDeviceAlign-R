{
    "contents" : "source(\"./utils.R\")\nsource(\"./timealign_3_3_speedud.R\")\nsource(\"./getMatrixByMag.R\")\nsource(\"./addPCAData.R\")\nsource(\"./plot_debug.R\")\nlibrary(zoo)\n\n# globalacc = getGlobalAccByMag(top)\n# lowpasstop = rollapply(top,5,mean)\n# lowpasstop = as.data.frame(lowpasstop)\n# globalacclp = getGlobalAccByMag(lowpasstop)\n# matplot(cbind(globalacc[1:300,2],globalacclp[1:300,2]),type=\"l\")\n# plot(globalacc[,2],type = \"l\")\n\nselectIndex = 1:300\n\naddDeviceDataToPCA = addDeviceDataToPCA2\n\ngacctop = getGlobalAccByMag(top)\n\n# plot(gacctop[selectIndex,2],type=\"l\",main=\"top forward\")\n# cor(-Fc[selectIndex], gacctop[selectIndex,2])\n\nFc = computeFc() \ngetAngleSimple = function(mdata, tag=\"\", plot3d = F){\n  globalAcc = getGlobalAccByMag(mdata)[selectIndex,]\n  globalAcc[,3] = 0\n  Fi = globalAcc\n  tr = 0.01; results = c()\n  dimStr = c(\"x\",\"y\",\"z\")\n  for (dim in 1:3) {\n    # mean = 0;count = 0\n    fiFc = c()\n    \n    for (i in 1:length(Fc)) {\n      if (abs(Fc[i]) > tr) {\n        fiFc = c(fiFc, Fi[i,dim] / Fc[i])\n        # mean = mean + (Fi[i,dim] / abs(Fc[i])); count = count + 1\n      }\n    }\n    meanR = 0\n    if(length(fiFc)!=0) {\n      # print(fiFc)\n      sdFiFc = sd(fiFc)\n      meanFiFc = mean(fiFc)\n      fiFcfilted = fiFc[abs(fiFc)<2]\n      meanR = mean(fiFcfilted)\n      if(length(fiFcfilted)>0)\n      plot(fiFcfilted, type=\"l\", main=paste(tag,dimStr[dim],\"fi/|fc| mean:\",round(meanR,3)))\n    }\n    \n    # if(count!=0) {mean = mean / count} else { mean = 0}\n    results = c(results,meanR)\n  }\n  angle = computeAngle(results,c(0,1,0))\n  sig = getDirection(results, c(0,1,0),c(0,0,1))\n  print(tag)\n  print(results)\n  print(sig*angle)\n  if(plot3d){\n    init3d(tag)\n    myArrow3d(results*4,2)\n    for(i in 1:nrow(globalAcc)){\n      myArrow3d(globalAcc[i,])\n    }\n  }\n}\ngetAngleSimple(top, \"top\",F)\ngetAngleSimple(leftHand, \"leftHand\",F)\ngetAngleSimple(rightHand, \"rightHand\",F)\ngetAngleSimple(leftPants, \"leftPants\",F)\ngetAngleSimple(rightPants, \"rightPants\",F)\ngetAngleSimple(glass, \"glass\",F)\n\n",
    "created" : 1456724501708.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "59|13|65|2|\n",
    "hash" : "3196706991",
    "id" : "8E830724",
    "lastKnownWriteTime" : 1457005311,
    "path" : "~/workspace/R/multidevicealign/exp_Fc_Fi_new.R",
    "project_path" : "exp_Fc_Fi_new.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_source"
}